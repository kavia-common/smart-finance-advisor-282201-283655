{"is_source_file": true, "format": "Python", "description": "This file provides financial transaction analysis functions for a backend service, including computing summaries and behavioral insights based on transaction data from a database. It defines data structures, utility functions, and primary functions for analytics, such as computing totals, trends, and top categories.", "external_files": ["src/db/models"], "external_methods": ["sqlalchemy.select", "sqlalchemy.and_", "sqlalchemy.orm.Session"], "published": ["compute_summary", "compute_behaviors"], "classes": [{"name": "DateRange", "description": "A simple data class representing a start and end date for a date range, inclusive."}], "methods": [{"name": "date _coerce_date(d: date | datetime)", "description": "Converts a date or datetime object to a date object.", "scope": "", "scopeKind": ""}, {"name": "date _month_start(d: date)", "description": "Returns the first day of the month for a given date.", "scope": "", "scopeKind": ""}, {"name": "date _next_month_start(d: date)", "description": "Returns the first day of the month following the given date.", "scope": "", "scopeKind": ""}, {"name": "Tuple[Literal[\"day\",\"week\",\"month\"],DateRange] compute_date_range( period: Literal[\"day\", \"week\", \"month\"] | None, start: Optional[date], end: Optional[date], )", "description": "Calculates a normalized date range and infers the period granularity ('day', 'week', 'month') based on input or default logic.", "scope": "", "scopeKind": ""}, {"name": "list[Transaction] _fetch_transactions(db: Session, user_id: int, rng: DateRange)", "description": "Queries transactions for a user within a specified date range from the database.", "scope": "", "scopeKind": ""}, {"name": "bool _is_income(tx: Transaction)", "description": "Determines if a transaction is income based on its type or amount.", "scope": "", "scopeKind": ""}, {"name": "dict compute_summary( db: Session, user_id: int, period: Optional[Literal[\"day\", \"week\", \"month\"]] = None, start: Optional[date] = None, end: Optional[date] = None, )", "description": "Computes financial analytics summary over a specified date range for a user, including totals, trends, and category breakdowns.", "scope": "", "scopeKind": ""}, {"name": "dict compute_behaviors( db: Session, user_id: int, start: Optional[date] = None, end: Optional[date] = None, )", "description": "Provides behavioral insights such as top spending categories, most expensive day, and income days count for a user over a date range.", "scope": "", "scopeKind": ""}, {"name": "str bucket_key(d: date)", "scope": "compute_summary", "scopeKind": "function", "description": "unavailable"}], "calls": ["select", "and_", "Session.execute", "Transaction.date", "Transaction.user_id", "Transaction.type", "Transaction.amount", "Transaction.category"], "search-terms": ["analytics_service", "compute_summary", "compute_behaviors", "Transaction", "date range", "trend analysis", "category breakdown", "financial summary", "spending streaks"], "state": 2, "file_id": 14, "knowledge_revision": 125, "git_revision": "dfc0128133c1426ed8425c18521b34b454f4a56d", "revision_history": [{"59": ""}, {"63": "dfc0128133c1426ed8425c18521b34b454f4a56d"}, {"125": "dfc0128133c1426ed8425c18521b34b454f4a56d"}], "ctags": [{"_type": "tag", "name": "DateRange", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^class DateRange:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_coerce_date", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def _coerce_date(d: date | datetime) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date | datetime)"}, {"_type": "tag", "name": "_fetch_transactions", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def _fetch_transactions(db: Session, user_id: int, rng: DateRange) -> list[Transaction]:$/", "language": "Python", "typeref": "typename:list[Transaction]", "kind": "function", "signature": "(db: Session, user_id: int, rng: DateRange)"}, {"_type": "tag", "name": "_is_income", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def _is_income(tx: Transaction) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(tx: Transaction)"}, {"_type": "tag", "name": "_month_start", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def _month_start(d: date) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date)"}, {"_type": "tag", "name": "_next_month_start", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def _next_month_start(d: date) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date)"}, {"_type": "tag", "name": "bucket_key", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^    def bucket_key(d: date) -> str:$/", "file": true, "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(d: date)", "scope": "compute_summary", "scopeKind": "function"}, {"_type": "tag", "name": "compute_behaviors", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def compute_behaviors($/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "( db: Session, user_id: int, start: Optional[date] = None, end: Optional[date] = None, )"}, {"_type": "tag", "name": "compute_date_range", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def compute_date_range($/", "language": "Python", "typeref": "typename:Tuple[Literal[\"day\",\"week\",\"month\"],DateRange]", "kind": "function", "signature": "( period: Literal[\"day\", \"week\", \"month\"] | None, start: Optional[date], end: Optional[date], )"}, {"_type": "tag", "name": "compute_summary", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/analytics_service.py", "pattern": "/^def compute_summary($/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "( db: Session, user_id: int, period: Optional[Literal[\"day\", \"week\", \"month\"]] = None, start: Optional[date] = None, end: Optional[date] = None, )"}], "hash": "63e57ba87d663275c94f6372f48069e1", "format-version": 4, "code-base-name": "finance_backend", "filename": "finance_backend/src/services/analytics_service.py"}