{"is_source_file": true, "format": "Python", "description": "This file contains service functions for financial advice and goal projection, including transaction analysis, savings advice, and goal timeline computation in a backend finance application.", "external_files": ["src/db/models"], "external_methods": ["sqlalchemy.select", "sqlalchemy.orm.Session.execute", "sqlalchemy.orm.Session.scalars", "src.db.models.Goal", "src.db.models.Transaction"], "published": ["compute_savings_advice", "compute_goals_plan"], "classes": [{"name": "DateRange", "description": "A simple container class for a date range (inclusive), used internally for transaction filtering."}], "methods": [{"name": "date _today()", "description": "Returns the current date.", "scope": "", "scopeKind": ""}, {"name": "date _month_start(d: date)", "description": "Calculates the first day of the month for a given date.", "scope": "", "scopeKind": ""}, {"name": "date _next_month_start(d: date)", "description": "Calculates the first day of the next month following the given date.", "scope": "", "scopeKind": ""}, {"name": "DateRange _last_30_days_range()", "description": "Returns a DateRange object covering the last 30 days up to today.", "scope": "", "scopeKind": ""}, {"name": "list[Transaction] _fetch_transactions(db: Session, user_id: int, rng: DateRange)", "description": "Fetches transactions for a user within a specified date range from the database.", "scope": "", "scopeKind": ""}, {"name": "bool _is_income(tx: Transaction)", "description": "Determines if a transaction is income based on its type or amount.", "scope": "", "scopeKind": ""}, {"name": "tuple[float,Dict[str,float],float] _aggregate_spending_patterns(txs: list[Transaction])", "description": "Analyzes a list of transactions to compute total income, spend per category, and average daily spending.", "scope": "", "scopeKind": ""}, {"name": "dict compute_savings_advice( db: Session, user_id: int, period: Optional[str] = None, )", "description": "Provides savings advice based on last 30 days of transactions, including category reductions and savings targets.", "scope": "", "scopeKind": ""}, {"name": "dict compute_goals_plan( db: Session, user_id: int, today: Optional[date] = None, )", "description": "Projects timelines for financial goals based on recent income and spending patterns.", "scope": "", "scopeKind": ""}, {"name": "date add_months(d: date, months: int)", "scope": "compute_goals_plan", "scopeKind": "function", "description": "unavailable"}], "calls": ["select(Transaction)", "db.execute", "db.execute(select(Goal).where(Goal.user_id == user_id))", "date.today()"], "search-terms": ["advice_service", "compute_savings_advice", "compute_goals_plan", "transaction analysis", "financial goals", "spending patterns", "category reductions"], "state": 2, "file_id": 17, "knowledge_revision": 127, "git_revision": "82beffcf3c02c0577185c761679dee7b06d3dd45", "revision_history": [{"68": ""}, {"72": "82beffcf3c02c0577185c761679dee7b06d3dd45"}, {"126": "82beffcf3c02c0577185c761679dee7b06d3dd45"}, {"127": "82beffcf3c02c0577185c761679dee7b06d3dd45"}], "ctags": [{"_type": "tag", "name": "DateRange", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^class DateRange:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_aggregate_spending_patterns", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def _aggregate_spending_patterns(txs: list[Transaction]) -> tuple[float, Dict[str, float], float/", "language": "Python", "typeref": "typename:tuple[float,Dict[str,float],float]", "kind": "function", "signature": "(txs: list[Transaction])"}, {"_type": "tag", "name": "_fetch_transactions", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def _fetch_transactions(db: Session, user_id: int, rng: DateRange) -> list[Transaction]:$/", "language": "Python", "typeref": "typename:list[Transaction]", "kind": "function", "signature": "(db: Session, user_id: int, rng: DateRange)"}, {"_type": "tag", "name": "_is_income", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def _is_income(tx: Transaction) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(tx: Transaction)"}, {"_type": "tag", "name": "_last_30_days_range", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def _last_30_days_range() -> DateRange:$/", "language": "Python", "typeref": "typename:DateRange", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_month_start", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def _month_start(d: date) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date)"}, {"_type": "tag", "name": "_next_month_start", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def _next_month_start(d: date) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date)"}, {"_type": "tag", "name": "_today", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def _today() -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "add_months", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^    def add_months(d: date, months: int) -> date:$/", "file": true, "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date, months: int)", "scope": "compute_goals_plan", "scopeKind": "function"}, {"_type": "tag", "name": "compute_goals_plan", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def compute_goals_plan($/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "( db: Session, user_id: int, today: Optional[date] = None, )"}, {"_type": "tag", "name": "compute_savings_advice", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/services/advice_service.py", "pattern": "/^def compute_savings_advice($/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "( db: Session, user_id: int, period: Optional[str] = None, )"}], "hash": "1b82227e85b63c652fac8fa8e146d724", "format-version": 4, "code-base-name": "finance_backend", "filename": "finance_backend/src/services/advice_service.py"}