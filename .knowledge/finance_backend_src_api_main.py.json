{"is_source_file": true, "format": "Python", "description": "Main FastAPI application setup file for the Smart Finance Advisor backend. It initializes the application, configures database migrations, registers API routers for various functionalities like transactions, budgets, goals, and includes startup routines to ensure database integrity and default data. It also defines a health check endpoint.", "external_files": ["src/db/session.py", "src/api/routers/seed.py", "src/api/routers/transactions.py", "src/api/routers/budgets.py", "src/api/routers/goals.py", "src/api/routers/analytics.py", "src/api/routers/alerts.py", "src/api/routers/advice.py", "src/api/routers/auth.py", "src/api/routers/income.py", "src/api/routers/expenses.py", "src/db/seed.py", "src/db/migrate.py"], "external_methods": ["src.db.session.get_db", "src.db.seed.ensure_default_user", "src.db.migrate.main"], "published": ["app", "health_check"], "classes": [], "methods": [{"name": "None _apply_migrations_best_effort()", "description": "Attempts to run SQL migrations or creates baseline tables and indexes if migrations are not available.", "scope": "", "scopeKind": ""}, {"name": "on_startup()", "description": "Event handler to initialize database tables, run migrations, repair legacy SQLite schemas, and ensure presence of default user during app startup.", "scope": "", "scopeKind": ""}, {"name": "health_check()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["migrate_main", "Base.metadata.create_all", "ensure_default_user", "uvicorn.run", "next(get_db())"], "search-terms": ["FastAPI application setup", "database migration", "initial database setup", "REST API router registration", "health check endpoint", "SQLite legacy repair", "default user creation"], "state": 2, "file_id": 1, "knowledge_revision": 124, "git_revision": "0090b77612fb9868ef1d756f22dca460846fe83e", "revision_history": [{"8": "71f912199a2a4e48f28ab4fd27ad24702b84b2c6"}, {"18": "71f912199a2a4e48f28ab4fd27ad24702b84b2c6"}, {"21": "049a946d4293b3f27890f2ca302f7a42e59d47aa"}, {"26": "049a946d4293b3f27890f2ca302f7a42e59d47aa"}, {"27": "049a946d4293b3f27890f2ca302f7a42e59d47aa"}, {"30": "ac964702809bb822a3a71d9c8d2bc0f33f1bd15d"}, {"33": "2e6b4795d89c31b01204beac9cf56011f9c25cdb"}, {"36": "5aee07987af510ae933ffc98867b81b513a1a29f"}, {"56": "a763128ff4b4b785b3f4ab204a7e976f9a07cd4f"}, {"62": "dfc0128133c1426ed8425c18521b34b454f4a56d"}, {"66": "6e0ab0b61921f3eb3fc6f29e4afe10e313dd62bd"}, {"71": "6e0ab0b61921f3eb3fc6f29e4afe10e313dd62bd"}, {"73": "f87e96deeea0e785e9a44378e73b58e0cea05c91"}, {"93": "f87e96deeea0e785e9a44378e73b58e0cea05c91"}, {"94": "f87e96deeea0e785e9a44378e73b58e0cea05c91"}, {"97": "4612dd2de54f2cb712144dc628c5259ac6d14cf0"}, {"101": "3dbc4cd651197e744b123ba56615a4f142d5e862"}, {"107": "6aef7e5178e53109813e03d22a2b0b08d7a9ea1f"}, {"108": "6aef7e5178e53109813e03d22a2b0b08d7a9ea1f"}, {"109": "df3f29719da32d8cf27aaecc9797224f77783152"}, {"124": "0090b77612fb9868ef1d756f22dca460846fe83e"}], "ctags": [{"_type": "tag", "name": "_apply_migrations_best_effort", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^def _apply_migrations_best_effort() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "advice_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.advice import router as advice_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "alerts_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.alerts import router as alerts_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "analytics_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.analytics import router as analytics_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auth_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.auth import router as auth_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "budgets_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.budgets import router as budgets_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "expenses_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.expenses import router as expenses_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "goals_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.goals import router as goals_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "income_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.income import router as income_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "migrate_main", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^        from src.db.migrate import main as migrate_main  # local import to avoid import cycles a/", "file": true, "language": "Python", "kind": "unknown", "scope": "_apply_migrations_best_effort", "scopeKind": "function", "nameref": "unknown:main"}, {"_type": "tag", "name": "on_startup", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^def on_startup():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "seed_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.seed import router as seed_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}, {"_type": "tag", "name": "transactions_router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/main.py", "pattern": "/^from src.api.routers.transactions import router as transactions_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:router"}], "hash": "0f0d5fcc75c0f91e2462a0e9b356cea0", "format-version": 4, "code-base-name": "finance_backend", "filename": "finance_backend/src/api/main.py", "fields": [{"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}]}