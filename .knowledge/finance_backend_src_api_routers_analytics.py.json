{"is_source_file": true, "format": "Python", "description": "This file defines API routes for analytics features in a FastAPI project, including endpoints for computing financial summaries and behaviors, and their associated data models.", "external_files": ["src.core.security", "src.db.models", "src.db.session", "src.services.analytics_service"], "external_methods": ["get_current_user", "get_db", "compute_summary", "compute_behaviors"], "published": ["analytics_summary", "analytics_behaviors"], "classes": [{"name": "TrendPoint", "description": "Data model representing a point in a time trend, including period label, income, expenses, and net."}, {"name": "AnalyticsTotals", "description": "Data model summarizing total income, expenses, and net cash flow."}, {"name": "AnalyticsSummaryResponse", "description": "Response model for analytics summary, including range, period, totals, savings rate, average daily spend, category breakdown, and trend."}, {"name": "AnalyticsBehaviorCategory", "description": "Model representing a spending category and total amount spent."}, {"name": "AnalyticsBehaviorsResponse", "description": "Response model for behavior analytics, including range, top categories, most expensive day, and count of income days."}], "methods": [{"name": "AnalyticsSummaryResponse analytics_summary( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], period: Optional[Literal[\"day\", \"week\", \"month\"]] = Query(None, description=\"Aggregation period; defaults based on range size\"), start: Optional[date] = Query(None, description=\"Start date (YYYY-MM-DD)\"), end: Optional[date] = Query(None, description=\"End date (YYYY-MM-DD)\"), )", "description": "API endpoint to compute and return a financial analytics summary for the current user.", "scope": "", "scopeKind": ""}, {"name": "AnalyticsBehaviorsResponse analytics_behaviors( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], start: Optional[date] = Query(None, description=\"Start date (YYYY-MM-DD)\"), end: Optional[date] = Query(None, description=\"End date (YYYY-MM-DD)\"), )", "description": "API endpoint to provide behavioral analytics insights like top spending categories and most expensive day.", "scope": "", "scopeKind": ""}], "calls": ["compute_summary", "compute_behaviors"], "search-terms": ["analytics", "financial summary", "behavioral insights", "API router", "trend data", "category breakdown"], "state": 2, "file_id": 15, "knowledge_revision": 117, "git_revision": "dfc0128133c1426ed8425c18521b34b454f4a56d", "revision_history": [{"61": ""}, {"116": "dfc0128133c1426ed8425c18521b34b454f4a56d"}, {"117": "dfc0128133c1426ed8425c18521b34b454f4a56d"}], "ctags": [{"_type": "tag", "name": "AnalyticsBehaviorCategory", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^class AnalyticsBehaviorCategory(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "AnalyticsBehaviorsResponse", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^class AnalyticsBehaviorsResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "AnalyticsSummaryResponse", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^class AnalyticsSummaryResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "AnalyticsTotals", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^class AnalyticsTotals(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TrendPoint", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^class TrendPoint(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "amount", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    amount: float = Field(..., description=\"Total spent in category\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "AnalyticsBehaviorCategory", "scopeKind": "class"}, {"_type": "tag", "name": "analytics_behaviors", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^def analytics_behaviors($/", "language": "Python", "typeref": "typename:AnalyticsBehaviorsResponse", "kind": "function", "signature": "( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], start: Optional[date] = Query(None, description=\"Start date (YYYY-MM-DD)\"), end: Optional[date] = Query(None, description=\"End date (YYYY-MM-DD)\"), )"}, {"_type": "tag", "name": "analytics_summary", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^def analytics_summary($/", "language": "Python", "typeref": "typename:AnalyticsSummaryResponse", "kind": "function", "signature": "( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], period: Optional[Literal[\"day\", \"week\", \"month\"]] = Query(None, description=\"Aggregation period; defaults based on range size\"), start: Optional[date] = Query(None, description=\"Start date (YYYY-MM-DD)\"), end: Optional[date] = Query(None, description=\"End date (YYYY-MM-DD)\"), )"}, {"_type": "tag", "name": "avg_daily_spend", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    avg_daily_spend: float = Field(..., description=\"Average daily spending across the date rang/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "AnalyticsSummaryResponse", "scopeKind": "class"}, {"_type": "tag", "name": "category", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    category: str = Field(..., description=\"Category name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "AnalyticsBehaviorCategory", "scopeKind": "class"}, {"_type": "tag", "name": "category_breakdown", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    category_breakdown: Dict[str, float] = Field(default_factory=dict, description=\"Per-category/", "language": "Python", "typeref": "typename:Dict[str, float]", "kind": "variable", "scope": "AnalyticsSummaryResponse", "scopeKind": "class"}, {"_type": "tag", "name": "expenses", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    expenses: float = Field(..., description=\"Total expenses (positive) in this period\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "TrendPoint", "scopeKind": "class"}, {"_type": "tag", "name": "expenses", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    expenses: float = Field(..., description=\"Total expenses (positive) over the range\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "AnalyticsTotals", "scopeKind": "class"}, {"_type": "tag", "name": "income", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    income: float = Field(..., description=\"Total income in this period\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "TrendPoint", "scopeKind": "class"}, {"_type": "tag", "name": "income", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    income: float = Field(..., description=\"Total income over the range\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "AnalyticsTotals", "scopeKind": "class"}, {"_type": "tag", "name": "income_days_count", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    income_days_count: int = Field(..., description=\"Number of days having any income recorded\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class"}, {"_type": "tag", "name": "most_expensive_day", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    most_expensive_day: Optional[Dict[str, float | str]] = Field($/", "language": "Python", "typeref": "typename:Optional[Dict[str, float | str]]", "kind": "variable", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class"}, {"_type": "tag", "name": "net", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    net: float = Field(..., description=\"Net income - expenses for this period\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "TrendPoint", "scopeKind": "class"}, {"_type": "tag", "name": "net_cash_flow", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    net_cash_flow: float = Field(..., description=\"Income minus expenses over the range\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "AnalyticsTotals", "scopeKind": "class"}, {"_type": "tag", "name": "period", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    period: Literal[\"day\", \"week\", \"month\"] = Field(..., description=\"Aggregation period used\")$/", "language": "Python", "typeref": "typename:Literal[\"day\", \"week\", \"month\"]", "kind": "variable", "scope": "AnalyticsSummaryResponse", "scopeKind": "class"}, {"_type": "tag", "name": "period", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    period: str = Field(..., description=\"Time bucket label (YYYY-MM, YYYY-MM-DD, or ISO week 'Y/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "TrendPoint", "scopeKind": "class"}, {"_type": "tag", "name": "range", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    range: Dict[str, str] = Field(..., description=\"Start\\/end date in ISO\")$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class"}, {"_type": "tag", "name": "range", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    range: Dict[str, str] = Field(..., description=\"Start\\/end date in ISO\")$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "AnalyticsSummaryResponse", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^router = APIRouter(prefix=\"\\/analytics\", tags=[\"analytics\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "savings_rate", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    savings_rate: float = Field(..., description=\"Net \\/ Income * 100, 0 when income is 0\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "AnalyticsSummaryResponse", "scopeKind": "class"}, {"_type": "tag", "name": "top_spending_categories", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    top_spending_categories: List[AnalyticsBehaviorCategory] = Field(default_factory=list, descr/", "language": "Python", "typeref": "typename:List[AnalyticsBehaviorCategory]", "kind": "variable", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class"}, {"_type": "tag", "name": "trend", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/analytics.py", "pattern": "/^    trend: List[TrendPoint] = Field(default_factory=list, description=\"Time series over the requ/", "language": "Python", "typeref": "typename:List[TrendPoint]", "kind": "variable", "scope": "AnalyticsSummaryResponse", "scopeKind": "class"}], "hash": "dd42fa1bf3ed49e8f8cb7d2b38685579", "format-version": 4, "code-base-name": "finance_backend", "filename": "finance_backend/src/api/routers/analytics.py", "fields": [{"name": "float amount", "scope": "AnalyticsBehaviorCategory", "scopeKind": "class", "description": "unavailable"}, {"name": "float avg_daily_spend", "scope": "AnalyticsSummaryResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str category", "scope": "AnalyticsBehaviorCategory", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, float] category_breakdown", "scope": "AnalyticsSummaryResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "float expenses", "scope": "TrendPoint", "scopeKind": "class", "description": "unavailable"}, {"name": "float income", "scope": "TrendPoint", "scopeKind": "class", "description": "unavailable"}, {"name": "int income_days_count", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[Dict[str, float | str]] most_expensive_day", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "float net", "scope": "TrendPoint", "scopeKind": "class", "description": "unavailable"}, {"name": "float net_cash_flow", "scope": "AnalyticsTotals", "scopeKind": "class", "description": "unavailable"}, {"name": "Literal[\"day\", \"week\", \"month\"] period", "scope": "AnalyticsSummaryResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str period", "scope": "TrendPoint", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] range", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/analytics\", tags=[\"analytics\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "float savings_rate", "scope": "AnalyticsSummaryResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "List[AnalyticsBehaviorCategory] top_spending_categories", "scope": "AnalyticsBehaviorsResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "List[TrendPoint] trend", "scope": "AnalyticsSummaryResponse", "scopeKind": "class", "description": "unavailable"}]}