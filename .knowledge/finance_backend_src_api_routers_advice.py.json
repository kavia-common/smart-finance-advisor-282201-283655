{"is_source_file": true, "format": "Python", "description": "This file defines API route handlers for advice-related endpoints in a FastAPI application, including savings advice and goals planning. It includes data models for request and response schemas, and calls external services to compute advice and plans.", "external_files": ["src.core.security", "src.db.models", "src.db.session", "src.services.advice_service"], "external_methods": ["src.core.security.get_current_user", "src.db.session.get_db", "src.services.advice_service.compute_goals_plan", "src.services.advice_service.compute_savings_advice"], "published": ["advice_savings", "advice_goals_plan"], "classes": [{"name": "SavingsTargetAmounts", "description": "Data model for savings targets across daily, weekly, and monthly periods."}, {"name": "SavingsCategoryReduction", "description": "Data model for suggested savings reduction per category."}, {"name": "SavingsAdviceResponse", "description": "Response schema for savings advice, including targets and reductions."}, {"name": "GoalPlanItem", "description": "Representation of a single goal's projection details."}, {"name": "GoalsPlanResponse", "description": "Response schema for goals planning projections."}], "methods": [{"name": "SavingsAdviceResponse advice_savings( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], period: Optional[str] = Query( \"month\", description=\"Target period for focus of the response: day | week | month\", ), )", "description": "Handles GET requests to provide personalized savings advice, computes targets and reductions.", "scope": "", "scopeKind": ""}, {"name": "GoalsPlanResponse advice_goals_plan( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], )", "description": "Handles GET requests to provide timeline projections for user goals based on current savings baseline.", "scope": "", "scopeKind": ""}], "calls": ["compute_savings_advice", "compute_goals_plan"], "search-terms": ["advice", "savings", "goals plan", "APIRouter", "pydantic", "FastAPI", "savings_target", "goal"], "state": 2, "file_id": 18, "knowledge_revision": 119, "git_revision": "8a28d201eebe9ba4324ed391135246613f99da8a", "revision_history": [{"70": ""}, {"119": "8a28d201eebe9ba4324ed391135246613f99da8a"}], "ctags": [{"_type": "tag", "name": "GoalPlanItem", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^class GoalPlanItem(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "GoalsPlanResponse", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^class GoalsPlanResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SavingsAdviceResponse", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^class SavingsAdviceResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SavingsCategoryReduction", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^class SavingsCategoryReduction(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SavingsTargetAmounts", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^class SavingsTargetAmounts(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "advice_goals_plan", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^def advice_goals_plan($/", "language": "Python", "typeref": "typename:GoalsPlanResponse", "kind": "function", "signature": "( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], )"}, {"_type": "tag", "name": "advice_savings", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^def advice_savings($/", "language": "Python", "typeref": "typename:SavingsAdviceResponse", "kind": "function", "signature": "( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], period: Optional[str] = Query( \"month\", description=\"Target period for focus of the response: day | week | month\", ), )"}, {"_type": "tag", "name": "baseline", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    baseline: Dict[str, float] = Field(..., description=\"Baseline stats such as monthly_net and /", "language": "Python", "typeref": "typename:Dict[str, float]", "kind": "variable", "scope": "GoalsPlanResponse", "scopeKind": "class"}, {"_type": "tag", "name": "category", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    category: str = Field(..., description=\"Category name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SavingsCategoryReduction", "scopeKind": "class"}, {"_type": "tag", "name": "category_reductions", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    category_reductions: List[SavingsCategoryReduction] = Field($/", "language": "Python", "typeref": "typename:List[SavingsCategoryReduction]", "kind": "variable", "scope": "SavingsAdviceResponse", "scopeKind": "class"}, {"_type": "tag", "name": "current", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    current: Dict[str, float] = Field(..., description=\"Current totals: income, expenses, net\")$/", "language": "Python", "typeref": "typename:Dict[str, float]", "kind": "variable", "scope": "SavingsAdviceResponse", "scopeKind": "class"}, {"_type": "tag", "name": "current", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    current: float = Field(..., description=\"Current spend in the category over the analysis win/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SavingsCategoryReduction", "scopeKind": "class"}, {"_type": "tag", "name": "daily", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    daily: float = Field(..., description=\"Target daily net savings\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SavingsTargetAmounts", "scopeKind": "class"}, {"_type": "tag", "name": "goals", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    goals: List[GoalPlanItem] = Field(default_factory=list, description=\"Goals with projections\"/", "language": "Python", "typeref": "typename:List[GoalPlanItem]", "kind": "variable", "scope": "GoalsPlanResponse", "scopeKind": "class"}, {"_type": "tag", "name": "monthly", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    monthly: float = Field(..., description=\"Target monthly net savings\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SavingsTargetAmounts", "scopeKind": "class"}, {"_type": "tag", "name": "months_to_target", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    months_to_target: Optional[float] = Field($/", "language": "Python", "typeref": "typename:Optional[float]", "kind": "variable", "scope": "GoalPlanItem", "scopeKind": "class"}, {"_type": "tag", "name": "period", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    period: str = Field(..., description=\"Requested aggregation focus period\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "SavingsAdviceResponse", "scopeKind": "class"}, {"_type": "tag", "name": "projected_completion", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    projected_completion: Optional[str] = Field($/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "GoalPlanItem", "scopeKind": "class"}, {"_type": "tag", "name": "range", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    range: Dict[str, str] = Field(..., description=\"Start\\/end dates used for the analysis\")$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "SavingsAdviceResponse", "scopeKind": "class"}, {"_type": "tag", "name": "range", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    range: Dict[str, str] = Field(..., description=\"Start\\/end for baseline window\")$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "GoalsPlanResponse", "scopeKind": "class"}, {"_type": "tag", "name": "reduced_amount", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    reduced_amount: float = Field(..., description=\"Amount to reduce for this category\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SavingsCategoryReduction", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^router = APIRouter(prefix=\"\\/advice\", tags=[\"advice\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    status: str = Field(..., description=\"on_track | ahead | behind | no_net\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "GoalPlanItem", "scopeKind": "class"}, {"_type": "tag", "name": "suggested_reduction_pct", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    suggested_reduction_pct: float = Field(..., description=\"Suggested reduction percent for thi/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SavingsCategoryReduction", "scopeKind": "class"}, {"_type": "tag", "name": "target_date", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    target_date: Optional[str] = Field(None, description=\"Goal target date (YYYY-MM-DD) if provi/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "GoalPlanItem", "scopeKind": "class"}, {"_type": "tag", "name": "targets", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    targets: SavingsTargetAmounts = Field(..., description=\"Savings targets by period\")$/", "language": "Python", "typeref": "typename:SavingsTargetAmounts", "kind": "variable", "scope": "SavingsAdviceResponse", "scopeKind": "class"}, {"_type": "tag", "name": "weekly", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/advice.py", "pattern": "/^    weekly: float = Field(..., description=\"Target weekly net savings\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "SavingsTargetAmounts", "scopeKind": "class"}], "hash": "d9fac61658d66daf69181f457f31717a", "format-version": 4, "code-base-name": "finance_backend", "filename": "finance_backend/src/api/routers/advice.py", "fields": [{"name": "Dict[str, float] baseline", "scope": "GoalsPlanResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str category", "scope": "SavingsCategoryReduction", "scopeKind": "class", "description": "unavailable"}, {"name": "List[SavingsCategoryReduction] category_reductions", "scope": "SavingsAdviceResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, float] current", "scope": "SavingsAdviceResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "float current", "scope": "SavingsCategoryReduction", "scopeKind": "class", "description": "unavailable"}, {"name": "float daily", "scope": "SavingsTargetAmounts", "scopeKind": "class", "description": "unavailable"}, {"name": "List[GoalPlanItem] goals", "scope": "GoalsPlanResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "float monthly", "scope": "SavingsTargetAmounts", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[float] months_to_target", "scope": "GoalPlanItem", "scopeKind": "class", "description": "unavailable"}, {"name": "str period", "scope": "SavingsAdviceResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] projected_completion", "scope": "GoalPlanItem", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] range", "scope": "SavingsAdviceResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "float reduced_amount", "scope": "SavingsCategoryReduction", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/advice\", tags=[\"advice\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str status", "scope": "GoalPlanItem", "scopeKind": "class", "description": "unavailable"}, {"name": "float suggested_reduction_pct", "scope": "SavingsCategoryReduction", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] target_date", "scope": "GoalPlanItem", "scopeKind": "class", "description": "unavailable"}, {"name": "SavingsTargetAmounts targets", "scope": "SavingsAdviceResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "float weekly", "scope": "SavingsTargetAmounts", "scopeKind": "class", "description": "unavailable"}]}