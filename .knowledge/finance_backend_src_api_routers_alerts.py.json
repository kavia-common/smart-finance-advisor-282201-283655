{"is_source_file": true, "format": "Python", "description": "This file defines a FastAPI router for generating overspending alerts in a financial application. It includes data models for alert items, utilities for date parsing and severity determination, and an endpoint that calculates budgets and expenses for a specified month, then returns categorization of overspending levels.", "external_files": ["src.core.security", "src.db.models", "src.db.session"], "external_methods": ["get_current_user", "get_db"], "published": ["router"], "classes": [{"name": "OverspendingItem", "description": "Pydantic model representing an overspending alert for a specific category in a given month."}, {"name": "OverspendingResponse", "description": "Pydantic model encapsulating the overspending alerts for a month, including a list of OverspendingItem objects."}], "methods": [{"name": "date _parse_month(month: str)", "description": "Parses a string in YYYY-MM format into a date object representing the first day of that month.", "scope": "", "scopeKind": ""}, {"name": "date _next_month_start(d: date)", "description": "Calculates the date representing the first day of the month following the given date.", "scope": "", "scopeKind": ""}, {"name": "str _severity(utilization_pct: float)", "description": "Determines the severity level ('normal', 'warning', 'critical') based on utilization percentage.", "scope": "", "scopeKind": ""}, {"name": "OverspendingResponse overspending_alerts( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], month: str = Query(..., description=\"Target month in YYYY-MM\"), )", "description": "API endpoint that computes overspending alerts for a specified month by comparing category budgets and transaction expenses.", "scope": "", "scopeKind": ""}], "calls": ["get_db", "get_current_user", "select", "and_", "func.sum", "date", "HTTPException", "_parse_month", "_next_month_start", "_severity"], "search-terms": ["overspending", "alerts", "financial", "monthly", "category", "budget", "API router"], "state": 2, "file_id": 16, "knowledge_revision": 118, "git_revision": "8a28d201eebe9ba4324ed391135246613f99da8a", "revision_history": [{"65": ""}, {"118": "8a28d201eebe9ba4324ed391135246613f99da8a"}], "ctags": [{"_type": "tag", "name": "OverspendingItem", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^class OverspendingItem(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OverspendingResponse", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^class OverspendingResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_next_month_start", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def _next_month_start(d: date) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date)"}, {"_type": "tag", "name": "_parse_month", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def _parse_month(month: str) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(month: str)"}, {"_type": "tag", "name": "_severity", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def _severity(utilization_pct: float) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(utilization_pct: float)"}, {"_type": "tag", "name": "budget", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    budget: float = Field(..., description=\"Budgeted amount for the month\\/category\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "category", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    category: str = Field(..., description=\"Category name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    items: List[OverspendingItem] = Field(default_factory=list, description=\"Per-category oversp/", "language": "Python", "typeref": "typename:List[OverspendingItem]", "kind": "variable", "scope": "OverspendingResponse", "scopeKind": "class"}, {"_type": "tag", "name": "month", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    month: str = Field(..., description=\"Month evaluated (YYYY-MM)\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingResponse", "scopeKind": "class"}, {"_type": "tag", "name": "month", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    month: str = Field(..., description=\"Month in YYYY-MM\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "overspending_alerts", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def overspending_alerts($/", "language": "Python", "typeref": "typename:OverspendingResponse", "kind": "function", "signature": "( db: Annotated[Session, Depends(get_db)], current_user: Annotated[User, Depends(get_current_user)], month: str = Query(..., description=\"Target month in YYYY-MM\"), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^router = APIRouter(prefix=\"\\/alerts\", tags=[\"alerts\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "severity", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    severity: str = Field(..., description=\"Severity level: normal | warning | critical\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "spent", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    spent: float = Field(..., description=\"Total spent amount (expenses only, positive value)\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "utilization_pct", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    utilization_pct: float = Field(..., description=\"Spent \\/ Budget * 100 (0 when budget is 0)\"/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}], "hash": "ea07054655a62fa699e4507a1147fe82", "format-version": 4, "code-base-name": "finance_backend", "filename": "finance_backend/src/api/routers/alerts.py", "fields": [{"name": "float budget", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "str category", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "List[OverspendingItem] items", "scope": "OverspendingResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str month", "scope": "OverspendingResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/alerts\", tags=[\"alerts\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str severity", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "float spent", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "float utilization_pct", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}]}