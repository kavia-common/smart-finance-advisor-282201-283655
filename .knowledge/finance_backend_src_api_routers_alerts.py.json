{"is_source_file": true, "format": "Python", "description": "This file implements an API endpoint using FastAPI to compute and retrieve overspending alerts for a specified month. It defines data models for the response, helper functions for date parsing and severity classification, and the main route handler that queries the database for budgets and transactions, calculating utilization percentages and severity levels categorized by expense categories.", "external_files": ["src/db/models", "src/db/session"], "external_methods": ["get_db", "select", "and_", "func.sum", "Transaction.category", "Transaction.amount", "Transaction.type", "Transaction.date", "Budget.user_id", "Budget.month"], "published": ["overspending_alerts"], "classes": [{"name": "OverspendingItem", "description": "Data model representing an overspending alert item with details about the category, budget, spent amount, utilization percentage, and severity."}, {"name": "OverspendingResponse", "description": "Response model encapsulating the list of overspending items for a specific month."}], "methods": [{"name": "date _parse_month(month: str)", "description": "Parses a YYYY-MM formatted string into a date object representing the first day of that month.", "scope": "", "scopeKind": ""}, {"name": "date _next_month_start(d: date)", "description": "Calculates the first day of the month following the given date.", "scope": "", "scopeKind": ""}, {"name": "str _severity(utilization_pct: float)", "description": "Determines severity level ('normal', 'warning', 'critical') based on utilization percentage.", "scope": "", "scopeKind": ""}, {"name": "OverspendingResponse overspending_alerts( db: Annotated[Session, Depends(get_db)], month: str = Query(..., description=\"Target month in YYYY-MM\"), )", "description": "Main API endpoint function that queries the database to compute and return overspending alerts per category for a specified month.", "scope": "", "scopeKind": ""}], "calls": ["get_db", "select", "and_", "func.sum", "_parse_month", "_next_month_start", "_severity"], "search-terms": ["overspending", "alerts", "monthly", "category spending", "budget utilization", "FastAPI route", "API handler", "SPARQL budget queries"], "state": 2, "file_id": 16, "knowledge_revision": 65, "git_revision": "", "ctags": [{"_type": "tag", "name": "OverspendingItem", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^class OverspendingItem(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "OverspendingResponse", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^class OverspendingResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_next_month_start", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def _next_month_start(d: date) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(d: date)"}, {"_type": "tag", "name": "_parse_month", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def _parse_month(month: str) -> date:$/", "language": "Python", "typeref": "typename:date", "kind": "function", "signature": "(month: str)"}, {"_type": "tag", "name": "_severity", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def _severity(utilization_pct: float) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(utilization_pct: float)"}, {"_type": "tag", "name": "budget", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    budget: float = Field(..., description=\"Budgeted amount for the month\\/category\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "category", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    category: str = Field(..., description=\"Category name\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    items: List[OverspendingItem] = Field(default_factory=list, description=\"Per-category oversp/", "language": "Python", "typeref": "typename:List[OverspendingItem]", "kind": "variable", "scope": "OverspendingResponse", "scopeKind": "class"}, {"_type": "tag", "name": "month", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    month: str = Field(..., description=\"Month evaluated (YYYY-MM)\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingResponse", "scopeKind": "class"}, {"_type": "tag", "name": "month", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    month: str = Field(..., description=\"Month in YYYY-MM\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "overspending_alerts", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^def overspending_alerts($/", "language": "Python", "typeref": "typename:OverspendingResponse", "kind": "function", "signature": "( db: Annotated[Session, Depends(get_db)], month: str = Query(..., description=\"Target month in YYYY-MM\"), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^router = APIRouter(prefix=\"\\/alerts\", tags=[\"alerts\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "severity", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    severity: str = Field(..., description=\"Severity level: normal | warning | critical\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "spent", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    spent: float = Field(..., description=\"Total spent amount (expenses only, positive value)\")$/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}, {"_type": "tag", "name": "utilization_pct", "path": "/home/kavia/workspace/code-generation/smart-finance-advisor-282201-283655/finance_backend/src/api/routers/alerts.py", "pattern": "/^    utilization_pct: float = Field(..., description=\"Spent \\/ Budget * 100 (0 when budget is 0)\"/", "language": "Python", "typeref": "typename:float", "kind": "variable", "scope": "OverspendingItem", "scopeKind": "class"}], "hash": "92582fb47c7288169f915ddeb6a90b52", "format-version": 4, "code-base-name": "finance_backend", "filename": "finance_backend/src/api/routers/alerts.py", "fields": [{"name": "float budget", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "str category", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "List[OverspendingItem] items", "scope": "OverspendingResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str month", "scope": "OverspendingResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/alerts\", tags=[\"alerts\"])", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str severity", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "float spent", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}, {"name": "float utilization_pct", "scope": "OverspendingItem", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"65": ""}]}